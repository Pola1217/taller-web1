{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,mDCAAD,EAAAC,EAAA,qBDOA,MAAMC,EAAqBC,SAASC,eAAe,eAC7CC,EAAuBF,SAASC,eAAe,iBASrDE,eAAeC,IACX,MAAMC,EARV,SAAkBC,GACd,MAAMC,EAAMC,OAAOC,SAASC,OAG5B,OAFqB,IAAIC,gBAAgBJ,GACVK,IAAIN,GAKjBO,CAAS,OAW/B,SAAuBC,GACnBZ,EAAqBa,UAAY,6DACqBD,EAAKE,OAAO,OAElEjB,EAAmBgB,UAAY,mCACHD,EAAKG,kDACCH,EAAKI,oGAEXJ,EAAKK,gDACJC,EAAAC,eAAeP,EAAKQ,sEAG7CR,EAAKE,OAAOO,OAAS,GAoB7B,SAAuBP,GACnB,MAAMQ,EAAYxB,SAASC,eAAe,aAEpCwB,EAAUzB,SAAS0B,cAAc,OACvCD,EAAQE,UAAY,mBAEpBX,EAAOY,SAAQC,IACXJ,EAAQV,WAAa,aAAac,SAGtC3B,EAAqB4B,YAAYL,GAEXzB,SAAS+B,cAAc,qBAE/BC,iBAAiB,SAASC,IACX,QAArBA,EAAEC,OAAOC,SACTX,EAAUY,aAAa,MAAOH,EAAEC,OAAOG,eAnC3CC,CAAcxB,EAAKE,QAGvB,MAAMuB,EAAiBvC,SAAS+B,cAAc,kBAC9CQ,EAAeP,iBAAiB,SAASC,IACrCO,KAAKC,KAAK3B,GAEVM,EAAAsB,iBAAiBF,MAEbG,YACAC,EAAAC,mBAAmBhD,EAAAiD,GAAIH,WAAWI,IAAKP,MAG3CD,EAAeH,aAAa,YAAY,GACxCG,EAAeS,UAAY,sBA9B/BC,CALgB,UClBpB9C,eAA0B+C,GACtB,MAAMC,EAASC,EAAAC,IAAIxD,EAAAiD,GAAI,WAAYI,GACnC,IAII,aAHsBE,EAAAE,OAAOH,IACRI,OAGvB,MAAMtB,GACJuB,QAAQC,IAAIxB,IDQGyB,CAAWrD,GAI1B6C,GAAI7C,IA2DZsD,EAAAC,mBAAmB/D,EAAAgE,MAAM1D,MAAO2D,IACxBA,GAGFnB,WAAamB,EACbtB,WAAaI,EAAAmB,gBAAgBlE,EAAAiD,GAAIH,WAAWI,KAC5CS,QAAQC,IAAIjB,OAGVA,KAAOpB,EAAA4C,iBAKX5D","sources":["src/product.js","src/functions/getProduct.js"],"sourcesContent":["import { db, auth } from \"./app\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { getFirebaseCart, createFirebaseCart } from \"./functions/cart\";\nimport { getMyLocalCart, addProductToCart, currencyFormat } from \"./utils\";\nimport { getProduct } from \"./functions/getProduct\";\n\n\nconst productInfoSection = document.getElementById(\"productInfo\");\nconst productAssetsSection = document.getElementById(\"productAssets\");\n\nfunction getParam(param) {\n    const url = window.location.search;\n    const searchParams = new URLSearchParams(url);\n    const productId = searchParams.get(param);\n    return productId;\n}\n\nasync function loadProduct() {\n    const productId = getParam(\"id\"); \n    const data = await getProduct(productId);\n\n    const product = {\n        ...data,\n        id: productId,\n    }\n\n    renderProduct(product);\n}\n\nfunction renderProduct(item) {\n    productAssetsSection.innerHTML = `\n    <img class=\"product__mainImage\" id=\"mainImage\" src=\"${item.images[0]}\">`;\n\n    productInfoSection.innerHTML = `\n    <h1 class=\"product__name\">${item.name}</h1>\n    <p class=\"product__description\">${item.description}</p>\n    <p class=\"product__howToUse\">How to use:</p>\n    <p class=\"product__howTo\">${item.howToUse}</p>\n    <h3 class=\"product__price\">${currencyFormat(item.price)}</h3>\n    <button class=\"product__cart\">Add to cart</button>`;\n\n    if (item.images.length > 1) {\n        createGallery(item.images);\n    }\n\n    const productCartBtn = document.querySelector(\".product__cart\");\n    productCartBtn.addEventListener(\"click\", e => {\n        cart.push(item);\n\n        addProductToCart(cart);\n\n        if (userLogged) {\n            createFirebaseCart(db, userLogged.uid, cart);\n        }\n\n        productCartBtn.setAttribute(\"disabled\", true);\n        productCartBtn.innerText = \"Producto aÃ±adido\";\n    });\n\n}\n\nfunction createGallery(images) {\n    const mainImage = document.getElementById(\"mainImage\");\n\n    const gallery = document.createElement(\"div\");\n    gallery.className = \"product__gallery\";\n\n    images.forEach(image => {\n        gallery.innerHTML += `<img src=\"${image}\">`;\n    });\n\n    productAssetsSection.appendChild(gallery);\n\n    const galleryImages = document.querySelector(\".product__gallery\");\n\n    galleryImages.addEventListener(\"click\", e => {\n        if (e.target.tagName === \"IMG\") {\n            mainImage.setAttribute(\"src\", e.target.currentSrc);\n        }\n    });\n}\n\nonAuthStateChanged(auth, async (user) => {\n    if (user) {\n      // User is signed in, see docs for a list of available properties\n      // https://firebase.google.com/docs/reference/js/firebase.User\n      userLogged = user;\n      cart = await getFirebaseCart(db, userLogged.uid);\n      console.log(cart);\n      // ...\n    } else {\n        cart = getMyLocalCart();\n      // User is signed out\n      // ...\n    }\n\n    loadProduct();\n\n  });","import { db } from \"../app\";\nimport { doc, getDoc } from \"firebase/firestore\";\n\nasync function getProduct(id) {\n    const docRef = doc(db, \"products\", id);\n    try {\n        const docSnap = await getDoc(docRef);\n        const data = docSnap.data();\n    \n        return data; \n    } catch(e) {\n        console.log(e);\n    }\n}\n\nexport {\n    getProduct\n}"],"names":["$jQQXv","parcelRequire","$4561a5f183cf30d8$var$productInfoSection","document","getElementById","$4561a5f183cf30d8$var$productAssetsSection","async","$4561a5f183cf30d8$var$loadProduct","productId","param","url","window","location","search","URLSearchParams","get","$4561a5f183cf30d8$var$getParam","item","innerHTML","images","name","description","howToUse","$2EF88","currencyFormat","price","length","mainImage","gallery","createElement","className","forEach","image","appendChild","querySelector","addEventListener","e","target","tagName","setAttribute","currentSrc","$4561a5f183cf30d8$var$createGallery","productCartBtn","cart","push","addProductToCart","userLogged","$6naOk","createFirebaseCart","db","uid","innerText","$4561a5f183cf30d8$var$renderProduct","id","docRef","$etBjH","doc","getDoc","data","console","log","$357632b3e2ee1ce0$export$e2005c9600188ac7","$1tHc5","onAuthStateChanged","auth","user","getFirebaseCart","getMyLocalCart"],"version":3,"file":"product.c3503697.js.map"}