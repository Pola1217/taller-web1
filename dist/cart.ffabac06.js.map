{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,6DAMA,MAAMC,EAAcC,SAASC,eAAe,QACtCC,EAAeF,SAASC,eAAe,SACvCE,EAAeH,SAASC,eAAe,kBAC7C,IAAIG,EAAO,GACPC,EAAQ,EACRC,EAAQ,GAEZ,SAASC,EAASC,GAEdA,EAAKC,SAAQC,IACT,MAhBRC,KAgBgBA,EAhBhBC,MAgBsBA,GAAUF,EAClBG,EAAe,MACjBF,QACAC,GAEJN,EAAMQ,KAAKD,GA4BnB,SAAuBH,GACnB,MAAMK,EAAcf,SAASgB,cAAc,MAC3CD,EAAYE,UAAY,UACxBF,EAAYG,UAAY,mBACZR,EAAQS,OAAO,8DACCT,EAAQC,6CACPS,EAAAC,eAAeX,EAAQE,oEAIpDb,EAAYuB,YAAYP,GAExBA,EAAYQ,iBAAiB,SAASC,IACR,WAArBA,EAAEC,OAAOC,UACTC,QAAQC,IAAI,cACZC,MAAM,oBAlCnBC,eAA6BC,GACzB,MAAMC,EAAU5B,EAAK6B,QAAOvB,GAAWA,EAAQwB,KAAOH,IAEtD3B,EAAO4B,EAEHG,kBACMC,EAAAC,mBAAmBxC,EAAAyC,GAAIH,WAAWI,IAAKP,GAIjDZ,EAAAoB,iBAAiBR,GAEjBjC,EAAYmB,UAAY,GAExBX,EAASyB,GAqBAS,CAAc/B,EAAQwB,QA3C3BQ,CAAchC,GACdL,GAASsC,SAASjC,EAAQE,UAG9BV,EAAa0C,UAAYxB,EAAAC,eAAehB,GA4C5CF,EAAaoB,iBAAiB,UAAUO,MAAON,IAC3CA,EAAEqB,iBAEF,MAsBMC,EAAY,UAbD,MATJ3C,EAAaQ,KAAKoC,cACf5C,EAAa6C,QAAQD,WACxB5C,EAAa8C,KAAKF,gBACb5C,EAAa+C,UAAUH,mBAarB,SAZJ5C,EAAagD,KAAKJ,iBACf5C,EAAaiD,WAAWL,WAC9B5C,EAAakD,KAAKN,aAmB3BzC,QACAD,SAKE+B,EAAAkB,oBAAoBzD,EAAAyC,GAAIH,WAAWI,IAAKO,GAE9CjB,MAAM,eAGNO,EAAAmB,WAAW1D,EAAAyC,GAAIH,WAAWI,KAC1BnB,EAAAoC,oBACArD,EAAasD,WAGjBC,EAAAC,mBAAmB9D,EAAA+D,MAAM9B,MAAO+B,IACxBA,GAGF1B,WAAa0B,EACbzD,QAAagC,EAAA0B,gBAAgBjE,EAAAyC,GAAIH,WAAWI,MAE1CnC,EAAOgB,EAAA2C,iBAKXxD,EAASH","sources":["src/cart.js"],"sourcesContent":["import { auth, db } from \"./app\";\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { getFirebaseCart, createFirebaseCart, createFirebaseOrder, deleteCart } from \"./functions/cart\";\nimport { addProductToCart, deleteMyLocalCart } from \"./utils\";\nimport { getMyLocalCart, currencyFormat } from \"./utils/index\";\n\nconst cartSection = document.getElementById(\"cart\");\nconst totalSection = document.getElementById(\"total\");\nconst checkoutForm = document.getElementById(\"checkout__Form\");\nlet cart = [];\nlet total = 0;\nlet order = [];\n\nfunction loadCart(cart) {\n    \n    cart.forEach(product => {\n        const { name, price } = product;\n        const orderProduct = {\n            name,\n            price\n        }\n        order.push(orderProduct);\n        renderProduct(product);\n        total += parseInt(product.price);\n    });\n\n    totalSection.innerText = currencyFormat(total);\n\n};\n\nasync function removeProduct(productId) {\n    const newCart = cart.filter(product => product.id !== productId);\n    \n    cart = newCart;\n\n    if (userLogged) {\n        await createFirebaseCart(db, userLogged.uid, newCart);\n        \n    }\n\n    addProductToCart(newCart);\n\n    cartSection.innerHTML = \"\";\n\n    loadCart(newCart);\n\n}\n\n\nfunction renderProduct(product) {\n    const productCart = document.createElement(\"li\");\n    productCart.className = \"product\";\n    productCart.innerHTML = `\n    <img src=\"${product.images[0]}\" class=\"product__image\">\n    <h2 class=\"product__name\">${product.name}</h2>\n    <h3 class=\"product__price\">${currencyFormat(product.price)}</h3>\n    <button class=\"product__delete\">X</button>\n    `;\n\n    cartSection.appendChild(productCart);\n\n    productCart.addEventListener(\"click\", e => {\n         if (e.target.tagName === \"BUTTON\") {\n             console.log(\"remove it!\");\n             alert(\"Log in to remove\");\n             removeProduct(product.id);\n         }\n    })\n};\n\ncheckoutForm.addEventListener(\"submit\", async (e) => {\n    e.preventDefault();\n    \n    const name = checkoutForm.name.value;\n    const address = checkoutForm.address.value;\n    const city = checkoutForm.city.value;\n    const cellphone = checkoutForm.cellphone.value;\n    const cardNum = checkoutForm.card.value;\n    const expiration = checkoutForm.expiration.value;\n    const code = checkoutForm.code.value;\n\n\n    const userInfo = {\n       name,\n       address,\n       city, \n       cellphone \n    }\n\n    const paymentInfo = {\n        cardNum,\n        expiration,\n        code\n    }\n\n    const fullOrder = {\n        userInfo,\n        paymentInfo,\n        order,\n        total\n    }\n\n    //console.log(total);\n\n    await createFirebaseOrder(db, userLogged.uid, fullOrder);\n\n    alert(\"ORDER READY\");\n    //window.location.href = \"/index.html\";\n\n    deleteCart(db, userLogged.uid);\n    deleteMyLocalCart();\n    checkoutForm.reset();\n});\n\nonAuthStateChanged(auth, async (user) => {\n    if (user) {\n      // User is signed in, see docs for a list of available properties\n      // https://firebase.google.com/docs/reference/js/firebase.User\n      userLogged = user;\n      cart = await getFirebaseCart(db, userLogged.uid);\n    } else {\n        cart = getMyLocalCart();\n      // User is signed out\n      // ...\n    }\n\n    loadCart(cart);\n\n  });"],"names":["$jQQXv","parcelRequire","$d3ea86992b712cb9$var$cartSection","document","getElementById","$d3ea86992b712cb9$var$totalSection","$d3ea86992b712cb9$var$checkoutForm","$d3ea86992b712cb9$var$cart","$d3ea86992b712cb9$var$total","$d3ea86992b712cb9$var$order","$d3ea86992b712cb9$var$loadCart","cart","forEach","product","name","price","orderProduct","push","productCart","createElement","className","innerHTML","images","$2EF88","currencyFormat","appendChild","addEventListener","e","target","tagName","console","log","alert","async","productId","newCart","filter","id","userLogged","$6naOk","createFirebaseCart","db","uid","addProductToCart","$d3ea86992b712cb9$var$removeProduct","$d3ea86992b712cb9$var$renderProduct","parseInt","innerText","preventDefault","fullOrder","value","address","city","cellphone","card","expiration","code","createFirebaseOrder","deleteCart","deleteMyLocalCart","reset","$1tHc5","onAuthStateChanged","auth","user","getFirebaseCart","getMyLocalCart"],"version":3,"file":"cart.ffabac06.js.map"}